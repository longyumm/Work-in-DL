## use the file named weatherall.csv
import numpy as np 
from keras.models import Sequential 
from keras.layers.core import Dense,Activation
from keras.optimizers import Adam
from keras.utils import np_utils
import csv 
import pandas as pd

data_without_Na=[]
float_data=[]
divide_data=[]
with open ('weatherall.csv') as weather:
	all_lines=csv.reader(weather)
	for oneline in all_lines:
		for single in oneline:
			if single.isdigit():##find the Na and change it to 0
				data_without_Na.append(single)
			else:
				i=single.replace(single,'0')
				data_without_Na.append(i)

for po in data_without_Na:
	lo=float(po)
	float_data.append(lo)

##数据处理成float

for i in range(0,len(float_data),4):
	b=float_data[i:i+4]
	divide_data.append(b)

##将数据分组，以方便转换成矩阵

metrics_data=np.array(divide_data)
#print(metrics_data)
##转换成矩阵

x_train=metrics_data[:,0:3]
y_train=metrics_data[:,3]
#print(x_train)
#print(y_train)

model = Sequential()
model.add(Dense(32, input_dim=3, activation='relu'))
model.add(Dense(62, activation='elu'))
model.add(Dense(64, activation='elu'))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='logcosh',optimizer='Adam',metrics=['accuracy'])
model.fit(x_train, y_train,epochs=20,batch_size=1000)
score = model.evaluate(x_train, y_train, batch_size=20000)

print('accuracy',score[1])
