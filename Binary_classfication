## use the file named data.txt
import numpy as np 
from keras.models import Sequential 
from keras.layers.core import Dense,Activation
from keras.optimizers import Adam
from keras.utils import np_utils
import csv 
import pandas as pd

float_data=[]
divide_data=[]

with open('data.txt') as f:
	line=f.read().splitlines()
	for single in line:
		po=float(single)
		float_data.append(po)

##将数据进行float化

for i in range(0,len(float_data),25551):
	b=float_data[i:i+25551]
	divide_data.append(b)

##将数据分组，以方便转换成矩阵

metrics_data=np.array(divide_data).T
#print(metrics_data)
##转换成矩阵

x_train=metrics_data[:,0:3]
y_train=metrics_data[:,3]

print(x_train)
print(y_train)


model = Sequential()
model.add(Dense(10, input_dim=3, activation='elu'))
model.add(Dense(10,activation='elu'))
model.add(Dense(1, activation='sigmoid'))
model.compile(loss='logcosh',optimizer='Adam',metrics=['accuracy'])
model.fit(x_train, y_train,epochs=30,batch_size=200)
score = model.evaluate(x_train, y_train, batch_size=20000)

print('accuracy',score[1])
